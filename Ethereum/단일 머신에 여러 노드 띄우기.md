# 단일 머신에 여러 노드(geth) 띄우기

```bash
mkdir multinodes

cd multinodes

mkdir node1
mkdir node2
mkdir node3
```

### 동일한 genesis.json 파일을 이용해서 geth 초기화

```bash
geth --datadir ~/geth/multinodes/node1 init ~/geth/testnet/genesis.json

geth --datadir ~/geth/multinodes/node2 init ~/geth/testnet/genesis.json

geth --datadir ~/geth/multinodes/node3 init ~/geth/testnet/genesis.json

```

### 터미널을 세 개 띄워서 geth 노드 구동

```bash
# 터미널 1
cd geth/multinodes/node1

# 터미널 2
cd geth/multinodes/node2

# 터미널 3
cd geth/multinodes/node3
```

### 첫번째 노드는 부트 노드로 활용

부트 노드는 피어들을 관리해주는 역할

```bash
# 노드1 (터미널 1)
geth --datadir ~/geth/multinodes/node1 --networkid 4649 console

# 부트노드의 주소(enode)를 확인
admin.nodeInfo.enode
```

![geth multinode](./imgs/mtnd.png)

### 두번째 노드는 일반 노드로 활용

```bash
# 노드2 (터미널 2)
geth --datadir ~/geth/multinodes/node2 --networkid 4649 console --port 30304 --ipcdisable

# 부트노드에 피어로 등록
# admin.addPeer(부트노드의 enode 주소)
admin.addPeer("enode://3accf469e53f0899f395a013667f387a0be154cac40ea8fe05207930c579bc2b2724ed1f55f246651075861054b37ba88abed0850fef0d0fda3a1d4c3ab14f40@127.0.0.1:30303")
```

### 세번째 노드는 마이너(채굴)노드로 활용

```bash
# 노드3 (터미널 3)
geth --datadir ~/geth/multinodes/node3 --networkid 4649 console --port 30305 --ipcdisable

# 부트노드에 피어로 등록
# admin.addPeer(부트노드의 enode 주소)
admin.addPeer("enode://3accf469e53f0899f395a013667f387a0be154cac40ea8fe05207930c579bc2b2724ed1f55f246651075861054b37ba88abed0850fef0d0fda3a1d4c3ab14f40@127.0.0.1:30303")
```

### 노드 1에서 연결 확인

```bash
net.peerCount # 2를 출력한다

admin.peers
```

![geth multinode](./imgs/mtnd1.png)
