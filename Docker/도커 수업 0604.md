```bash

mkdir echo
cd echo

# /root/docker/echo 폴더와 echo 컨테이너의 /echo를 붙인다(공유?)
docker container run -d -p 9091:8080 -v /root/docker/echo:/echo echo

# localhost:9091을 호출
curl http://localhost:9091
Hello Docker !!!     # main.go의 내용

# main.go 파일 수정
vim main.go

# 컨테이너 재시작
docker container restart 397

# localhost:9091을 호출한다
curl http://localhost:9091
Hello Docker ^_____^     # 수정한 내용이 반영된다
```

## commit

```bash
# 컨테이너 id 397~ 을 ganzik/k_echo 이미지로 commit 한다
docker commit 397 ganzik/k_echo

# 도커 로그인
docker login

# ganzik/k_echo 이미지를 도커 허브에 푸쉬한다
docker push ganzik/k_echo
```

> build
> Dockerfile 을 참조해서 만든 이미지를 믿을 수 있다
>
> commit
> 어떻게 만들었는지 알 수 없다

```bash
# 호스트 포트를 지정하지 않으면 순차적으로 자동으로 작성된다
docker container run -d -p :8080 echo
```

문제)

1. runc.sh 스크립트를 작성

2. 파라미터로 컨테이너 이름을 받습니다.

3. 동일한 이름의 컨테이너가 존재하면 해당 컨테이너를 삭제 후 컨테이너를 생성(실행)한다.

4. 생성 스크립트는 다음과 같다.
   - docker container run --name 컨테이너이름 -itd -p 8888:8080 echo

5) runc.sh hello 명령을 입력하면 컨테이너가 실행된다.

runc.sh

```bash
#!/bin/bash

function msg () {
	printf "%s" $1
	for i in {1..5}
	do
		printf "%s" "."
		sleep 1
	done
}

# 명령어 형식을 체크 (파라미터 존재 여부를 확인)
if [ $# == 0 ]
then
	echo 명령어 사용법이 잘못되었습니다.
	echo [사용법] ./run.sh container_name
	exit 1
fi

# 컨테이너 실행 전 컨테이너 리스트를 출력
echo "----------------------------"
echo "실행전 docker container ps -a "
echo "----------------------------"
msg "실행전 컨테이너 목록을 조회합니다."
docker container ps -a

# 동일 이름의 컨테이너를 조회
cid=$(docker container ps --filter="name=^/$1$" -q)

# 동일 이름의 컨테이너가 존재하는 경우 해당 컨테이너를 삭제하고 메시지를 출력
if [ "$cid" != "" ]
then
	docker container rm -f $cid
	echo $1 이름의 컨테이너\($cid\)를 삭제했습니다.
fi

# 컨테이너를 실행. 만약 포트 중복을 피하려면 호스트 포트번호를 지워준다
docker container run --name $1 -itd -p 8888:8080 echo

# 컨테이너 실행후 컨테이너 리스트를 출력
echo "----------------------------"
echo "실행후 docker container ps -a "
echo "----------------------------"
msg "실행후 컨테이너 목록을 조회합니다."
docker container ps -a

# 쉘 종료
exit 0

```

```bash
# 포트 기준으로 뽑아내기

docker container ls -a | grep :8888

set $(docker container ls -a | grep :8888)
echo $1
```

## docker composer

<https://docs.docker.com/compose/install/>

```bash
curl -L "https://github.com/docker/compose/releases/download/1.24.0/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose


chmod +x /usr/local/bin/docker-compose

docker-compose --version

vim docker-compose.yml
```

```yml
version: "3"
services:
  echo:
    build: .
    ports:
      - 8080
  echo2:
    build: .
    ports:
      - 9091:8080
```

```bash
docker-compose up

docker-compose up --scale echo=10
```
